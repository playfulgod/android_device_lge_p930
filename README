Originally ported by bytecode64

pushed to github and submited to koush by PlayfulGod